<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>ex5_4_IFIDEMP</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library ex5_4_IFIDEMP</h1>

<div class="code">
<span class="id" title="keyword">Load</span> "ex5_4_IFTF".<br/>

<br/>
</div>

<div class="doc">
This library defines a theorem <span class="inlinecode"><span class="id" title="var">IFIDEMP</span></span> and its proof. Notice that we use <span class="inlinecode">#</span> (resp. <span class="inlinecode">##</span>) for <span class="inlinecode"><span class="id" title="var">message</span></span> (resp. <span class="inlinecode"><span class="id" title="var">Bool</span></span>) in lieu of <span class="inlinecode">=</span>.

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode">(<span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">x1</span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">y1</span>)</span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode">(<span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">x2</span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">y2</span>)</span> <span class="inlinecode">#</span> <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">x1</span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">y2</span></span> 
</div>
<div class="code">
<span class="id" title="keyword">Check</span> <span class="id" title="var">message_Bool_mutind</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">message_Bool_mutind_better</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">P</span> : <span class="id" title="var">message</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">P0</span> : <span class="id" title="var">Bool</span> -&gt; <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">P</span> (<span class="id" title="var">Mvar</span> <span class="id" title="var">n</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">acc</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">lsk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">lnc</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">P</span> (<span class="id" title="var">N</span> <span class="id" title="var">n</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> : <span class="id" title="var">Bool</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P0</span> <span class="id" title="var">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">ifm</span> <span class="id" title="var">b</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">exp</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span> <span class="id" title="var">m1</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">m</span>, <span class="id" title="var">m0</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">pi1</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">pi2</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">ggen</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">rr</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">new</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">act</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">m</span> <span class="id" title="var">m0</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">nc</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">enc</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span> <span class="id" title="var">m1</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">dec</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">to</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">k</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">sign</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">chksign</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">reveal</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">P</span> (<span class="id" title="var">i</span> <span class="id" title="var">n</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">L</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">rs</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">commit</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span> <span class="id" title="var">m1</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">open</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span> <span class="id" title="var">m1</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">blind</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span> <span class="id" title="var">m1</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m2</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m2</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">unblind</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">bsign</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">v</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">P</span> (<span class="id" title="var">V</span> <span class="id" title="var">n</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">ok</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">message</span>, <span class="id" title="var">P</span> (<span class="id" title="var">f</span> <span class="id" title="var">l</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">shuf</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">dv</span> <span class="id" title="var">m</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">P0</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P0</span> <span class="id" title="var">TRue</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P0</span> <span class="id" title="var">FAlse</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>:<span class="id" title="var">Bool</span>, <span class="id" title="var">P0</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">b1</span>:<span class="id" title="var">Bool</span>, <span class="id" title="var">P0</span> <span class="id" title="var">b1</span> -&gt; <span class="id" title="var">P0</span> (<span class="id" title="var">eqb</span> <span class="id" title="var">b</span> <span class="id" title="var">b1</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span>:<span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m2</span>:<span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m2</span> -&gt; <span class="id" title="var">P0</span> (<span class="id" title="var">eqm</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>: <span class="id" title="var">Bool</span>, <span class="id" title="var">P0</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">b1</span>:<span class="id" title="var">Bool</span>, <span class="id" title="var">P0</span> <span class="id" title="var">b1</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">b2</span>:<span class="id" title="var">Bool</span>, <span class="id" title="var">P0</span> <span class="id" title="var">b2</span> -&gt; <span class="id" title="var">P0</span> (<span class="id" title="var">ifb</span> <span class="id" title="var">b</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span>:<span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m2</span>:<span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m2</span> -&gt; <span class="id" title="var">P0</span> (<span class="id" title="var">EQL</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">P0</span> (<span class="id" title="var">ver</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span> <span class="id" title="var">m1</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">P0</span> (<span class="id" title="var">bver</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span> <span class="id" title="var">m1</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m0</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m0</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m1</span> -&gt;  <span class="id" title="keyword">forall</span> <span class="id" title="var">m2</span> : <span class="id" title="var">message</span>, <span class="id" title="var">P</span> <span class="id" title="var">m2</span> -&gt; <span class="id" title="var">P0</span> (<span class="id" title="var">bacc</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>)) -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">P</span> <span class="id" title="var">m</span>) /\ (<span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>, <span class="id" title="var">P0</span> <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">message_Bool_mutind</span>;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">invar</span> : (<span class="id" title="keyword">forall</span>  (<span class="id" title="var">m</span>:<span class="id" title="var">message</span>), <span class="id" title="var">m</span> # <span class="id" title="var">m</span>) /\ (<span class="id" title="keyword">forall</span>  (<span class="id" title="var">b</span>:<span class="id" title="var">Bool</span>), <span class="id" title="var">b</span> ## <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">message_Bool_mutind_better</span>); <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span>  <span class="id" title="var">invarsub_Bmsg</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">t</span>:<span class="id" title="var">message</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), ((<span class="id" title="var">n</span>:= (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>))<span class="id" title="var">t</span>  # <span class="id" title="var">t</span>)  /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="keyword">forall</span> (<span class="id" title="var">b</span>:<span class="id" title="var">Bool</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), ([<span class="id" title="var">n</span>:=(<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>)] <span class="id" title="var">b</span>) ## <span class="id" title="var">b</span>).<br/>

<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rew_hypm</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">_</span>,  <span class="id" title="var">_</span> # <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> ; <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id" title="var">H'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span> # <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H'</span> =&gt; <span class="id" title="tactic">fail</span> 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rew_hypb</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">_</span>,  <span class="id" title="var">_</span> ## <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> ; <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id" title="var">H'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span> ## <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H'</span> =&gt; <span class="id" title="tactic">fail</span> 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">message_Bool_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, ((<span class="id" title="var">n</span>:=(<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>))<span class="id" title="var">t</span>) # <span class="id" title="var">t</span> ) (<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, ([<span class="id" title="var">n</span>:=(<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>)]<span class="id" title="var">b</span>) ## <span class="id" title="var">b</span> ) ); <span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">try</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span> ;  <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> <span class="id" title="var">rew_hypm</span>;  <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> <span class="id" title="var">rew_hypb</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>;  <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>;  <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> ( <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span> ;  <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> <span class="id" title="var">rew_hypm</span>;  <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> <span class="id" title="var">rew_hypb</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span> ;  <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> <span class="id" title="var">rew_hypm</span>;  <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> <span class="id" title="var">rew_hypb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span> ;  <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> <span class="id" title="var">rew_hypm</span>;  <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> <span class="id" title="var">rew_hypb</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>, <span class="id" title="var">H0</span>, <span class="id" title="var">H1</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>, <span class="id" title="var">H0</span>, <span class="id" title="var">H1</span>.<br/>
<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">try</span> <br/>
<span class="id" title="tactic">simpl</span>.<br/>
(<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, ([<span class="id" title="var">n</span>:= (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>)] <span class="id" title="var">b</span>) ## <span class="id" title="var">b</span>)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subinmsg</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)(<span class="id" title="var">b</span>:<span class="id" title="var">Bool</span>) (<span class="id" title="var">t1</span>:<span class="id" title="var">message</span>), ( (<span class="id" title="var">subbol_os</span> <span class="id" title="var">n</span> <span class="id" title="var">b</span> <span class="id" title="var">t1</span> ) # (((<span class="id" title="var">n</span> := <span class="id" title="var">b</span>) <span class="id" title="var">t1</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">subinbol</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)(<span class="id" title="var">b</span>:<span class="id" title="var">Bool</span>) (<span class="id" title="var">t1</span>:<span class="id" title="var">Bool</span>), ( (<span class="id" title="var">subbol_os</span> <span class="id" title="var">n</span> <span class="id" title="var">b</span> (<span class="id" title="var">bol</span> <span class="id" title="var">t1</span>) ) ## (<span class="id" title="var">bol</span> ([<span class="id" title="var">n</span> := <span class="id" title="var">b</span>] <span class="id" title="var">t1</span>))).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">message</span>  <br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">IFIDEMP_B</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">n</span>: <span class="id" title="var">nat</span>)(<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> <span class="id" title="var">b3</span> <span class="id" title="var">b4</span> : <span class="id" title="var">Bool</span>), (<span class="id" title="var">ifb</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) (<span class="id" title="var">ifb</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) <span class="id" title="var">b1</span> <span class="id" title="var">b2</span>) (<span class="id" title="var">ifb</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) <span class="id" title="var">b3</span> <span class="id" title="var">b4</span>)) ## (<span class="id" title="var">ifb</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) <span class="id" title="var">b1</span> <span class="id" title="var">b4</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span>(<span class="id" title="var">Bool_message_ind</span> (<span class="id" title="keyword">fun</span> <br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> <span class="id" title="var">b3</span> <span class="id" title="var">b4</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IFEVAL_B</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">b1</span>:= <span class="id" title="var">ifb</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) <span class="id" title="var">b1</span> <span class="id" title="var">b2</span>)(<span class="id" title="var">b2</span> := (<span class="id" title="var">ifb</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) <span class="id" title="var">b3</span> <span class="id" title="var">b4</span>)) .<br/>
<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">beq_nat_refl</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IFTRUE_B</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IFFALSE_B</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IFEVAL_B</span> <span class="id" title="keyword">with</span>(<span class="id" title="var">b2</span>:=<span class="id" title="var">b4</span>).<br/>
<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">IFIDEMP_M</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">n</span>: <span class="id" title="var">nat</span>)(<span class="id" title="var">x1</span> <span class="id" title="var">x2</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span> : <span class="id" title="var">message</span>),  (<span class="id" title="var">ifm</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) (<span class="id" title="var">ifm</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) <span class="id" title="var">x1</span> <span class="id" title="var">y1</span>) (<span class="id" title="var">ifm</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) <span class="id" title="var">x2</span> <span class="id" title="var">y2</span>)) # (<span class="id" title="var">ifm</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) <span class="id" title="var">x1</span> <span class="id" title="var">y2</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span> .<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IFEVAL_M</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">t1</span>:= <span class="id" title="var">ifm</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) <span class="id" title="var">x1</span> <span class="id" title="var">y1</span>)(<span class="id" title="var">t2</span> := (<span class="id" title="var">ifm</span> (<span class="id" title="var">Bvar</span> <span class="id" title="var">n</span>) <span class="id" title="var">x2</span> <span class="id" title="var">y2</span>)) .<br/>
<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">beq_nat_refl</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IFTRUE_M</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IFFALSE_M</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IFEVAL_M</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">t2</span>:=<span class="id" title="var">y2</span>).<br/>
<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>