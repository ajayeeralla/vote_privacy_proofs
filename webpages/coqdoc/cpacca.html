<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>cpacca</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library cpacca</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">voteprivacy</span>.<br/>
<span class="id" title="keyword">Eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eqb</span> <span class="id" title="var">FAlse</span> <span class="id" title="var">FAlse</span>.<br/>
<span class="id" title="keyword">Eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eqm</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab7"></a><h1 class="section">Formalization of the section12 in the paper</h1>

<div class="paragraph"> </div>

 Auxiliary functions  
<div class="paragraph"> </div>

 Check if (rs n) occurs, and returns TRUE if (rs n) occurs, FALSE otherwise  It is enough to check if n occurs instead 
</div>
<div class="code">
&nbsp;<span class="id" title="keyword">Fixpoint</span>  <span class="id" title="var">checkrsnbol</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">t</span>:<span class="id" title="var">Bool</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
| <span class="id" title="var">eqb</span>  <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> =&gt;  (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnbol</span> <span class="id" title="var">n</span> <span class="id" title="var">b1</span>)  (<span class="id" title="var">checkrsnbol</span> <span class="id" title="var">n</span> <span class="id" title="var">b2</span>))<br/>
| <span class="id" title="var">eqm</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; <span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)<br/>
| <span class="id" title="var">ifb_then_else_</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; <span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnbol</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)(<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnbol</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)(<span class="id" title="var">checkrsnbol</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
| <span class="id" title="var">bver</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">orb</span>  (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
| <span class="id" title="var">ver</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">orb</span>  (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
| <span class="id" title="var">acc</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span>  <span class="id" title="var">t4</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">orb</span>  (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))  (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t4</span>))<br/>
| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;<span class="id" title="keyword">end</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">checkrsnmsg</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">t</span>:<span class="id" title="var">message</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">orb</span> (<span class="id" title="var">message_beq</span> (<span class="id" title="var">r</span> <span class="id" title="var">n</span>) <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">N</span> <span class="id" title="var">n'</span> =&gt;  (<span class="id" title="var">beq_nat</span> <span class="id" title="var">n'</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ifm_then_else_</span> <span class="id" title="var">b3</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnbol</span> <span class="id" title="var">n</span> <span class="id" title="var">b3</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span>  <span class="id" title="var">t1</span>)(<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pair</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">L</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pi1</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pi2</span> <span class="id" title="var">t1</span> =&gt;  (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">to</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">f</span> <span class="id" title="var">l</span> =&gt; (@<span class="id" title="var">existsb</span> <span class="id" title="var">message</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span>) <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
Vote Values 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">V0</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">V1</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
public key 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pubkey</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">kc</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">comm</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>))     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">open</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt;  <span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">shufl</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt;  <span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">re</span> <span class="id" title="var">t1</span> =&gt;  (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ke</span> <span class="id" title="var">t1</span> =&gt;  (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">enc</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt;  <span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dec</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; <span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">kb</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">rb</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bsign</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt;  <span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bl</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt;  <span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ub</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span>  <span class="id" title="var">t4</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">orb</span>  (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))  (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t4</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ks</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">rs</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">sign</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>)))  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Check if (r n) occurs in oursum 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">checkrsnos</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>)(<span class="id" title="var">t</span>:<span class="id" title="var">oursum</span>): <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">bol</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">checkrsnbol</span> <span class="id" title="var">n</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">msg</span> <span class="id" title="var">t</span> =&gt;<span class="id" title="var">checkrsnmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">checkrsnmylis</span> {<span class="id" title="var">m</span>:<span class="id" title="var">nat</span>}(<span class="id" title="var">x</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">ml</span> :  <span class="id" title="var">mylist</span> <span class="id" title="var">m</span>):<span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ml</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> : <span class="id" title="var">ml1</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">checkrsnos</span> <span class="id" title="var">x</span> <span class="id" title="var">h</span>) (<span class="id" title="var">checkrsnmylis</span> <span class="id" title="var">x</span> <span class="id" title="var">ml1</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Check if (sk n) occurs 
<div class="paragraph"> </div>

 Check in terms of type message and Bool  
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">checksknbol</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">t</span>:<span class="id" title="var">Bool</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
| <span class="id" title="var">eqb</span>  <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> =&gt;  (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknbol</span> <span class="id" title="var">n</span> <span class="id" title="var">b1</span>)  (<span class="id" title="var">checksknbol</span> <span class="id" title="var">n</span> <span class="id" title="var">b2</span>))<br/>
| <span class="id" title="var">eqm</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; <span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)<br/>
| <span class="id" title="var">ifb_then_else_</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; <span class="id" title="var">orb</span> (<span class="id" title="var">checksknbol</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)(<span class="id" title="var">orb</span> (<span class="id" title="var">checksknbol</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)(<span class="id" title="var">checksknbol</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
| <span class="id" title="var">bver</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">orb</span>  (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
| <span class="id" title="var">ver</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">orb</span>  (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
| <span class="id" title="var">acc</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span>  <span class="id" title="var">t4</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">orb</span>  (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))  (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t4</span>))<br/>
| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;<span class="id" title="keyword">end</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">checksknmsg</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">t</span>:<span class="id" title="var">message</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">orb</span> (<span class="id" title="var">message_beq</span> (<span class="id" title="var">r</span> <span class="id" title="var">n</span>) <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">N</span> <span class="id" title="var">n'</span> =&gt;  (<span class="id" title="var">beq_nat</span> <span class="id" title="var">n'</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ifm_then_else_</span> <span class="id" title="var">b3</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknbol</span> <span class="id" title="var">n</span> <span class="id" title="var">b3</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span>  <span class="id" title="var">t1</span>)(<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pair</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">L</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pi1</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pi2</span> <span class="id" title="var">t1</span> =&gt;  (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">to</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">f</span> <span class="id" title="var">l</span> =&gt; (@<span class="id" title="var">existsb</span> <span class="id" title="var">message</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span>) <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
Vote Values 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">V0</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">V1</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
public key 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pubkey</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">kc</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">comm</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>))     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">open</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt;  <span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">shufl</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt;  <span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">re</span> <span class="id" title="var">t1</span> =&gt;  (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ke</span> <span class="id" title="var">t1</span> =&gt;  (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">enc</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt;  <span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dec</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; <span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">kb</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">rb</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bsign</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt;  <span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bl</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt;  <span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ub</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span>  <span class="id" title="var">t4</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">orb</span>  (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>)) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>))  (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t4</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ks</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">rs</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">sign</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t3</span>)))  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="tactic">in</span> <span class="id" title="var">checksknmsg</span> 1 (<span class="id" title="var">pi1</span> (<span class="id" title="var">pi2</span>(<span class="id" title="var">kc</span> (<span class="id" title="var">N</span> 1)))  ).<br/>

<br/>
</div>

<div class="doc">
Check if (sk n) occurs in term of type oursum 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">checksknos</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>)(<span class="id" title="var">t</span>:<span class="id" title="var">oursum</span>): <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">bol</span> <span class="id" title="var">b</span> =&gt;<span class="id" title="var">checksknbol</span> <span class="id" title="var">n</span> <span class="id" title="var">b</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">msg</span> <span class="id" title="var">t</span> =&gt;<span class="id" title="var">checksknmsg</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Check if (sk n) occurs in term of type mylist m for some m 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">checksknmylis</span> {<span class="id" title="var">m</span>:<span class="id" title="var">nat</span>}(<span class="id" title="var">x</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">ml</span> :  <span class="id" title="var">mylist</span> <span class="id" title="var">m</span>):<span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ml</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> : <span class="id" title="var">ml1</span> =&gt; (<span class="id" title="var">orb</span> (<span class="id" title="var">checksknos</span> <span class="id" title="var">x</span> <span class="id" title="var">h</span>) (<span class="id" title="var">checksknmylis</span> <span class="id" title="var">x</span> <span class="id" title="var">ml1</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
list free variables in a term 
</div>
<div class="code">
</div>

<div class="doc">
<a name="lab8"></a><h1 class="section">Axioms</h1>

<div class="paragraph"> </div>

 Equational theory for asymmetric encryption scheme 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">dep_enc</span> :  <span class="id" title="keyword">forall</span>(<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">x</span> <span class="id" title="var">z</span> :<span class="id" title="var">message</span>), (<span class="id" title="var">dec</span> (<span class="id" title="var">enc</span> <span class="id" title="var">x</span> (<span class="id" title="var">pke</span> <span class="id" title="var">n</span>) <span class="id" title="var">z</span>) (<span class="id" title="var">ske</span> <span class="id" title="var">n</span>)) # <span class="id" title="var">x</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;'[' x '&lt;-' s ']' l" :=  (<span class="id" title="var">submsg_mylist</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span> <span class="id" title="var">l</span>).<br/>

<br/>
</div>

<div class="doc">
ENCCPA assumption 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">ENCCPA</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">u''</span>: <span class="id" title="var">message</span>) (<span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span> <span class="id" title="var">n3</span> :<span class="id" title="var">nat</span>) {<span class="id" title="var">m</span>} (<span class="id" title="var">l</span>:<span class="id" title="var">mylist</span> <span class="id" title="var">m</span>), (<span class="id" title="var">leb</span> (<span class="id" title="var">length</span> (<span class="id" title="var">distMvars</span> <span class="id" title="var">l</span>)) 1) = <span class="id" title="var">true</span> /\ (<span class="id" title="var">closMlist</span> [<span class="id" title="var">u</span>; <span class="id" title="var">u'</span>; <span class="id" title="var">u''</span>] = <span class="id" title="var">true</span>) /\ ((<span class="id" title="var">checkrsnmylis</span> <span class="id" title="var">n2</span> <span class="id" title="var">l</span>) = <span class="id" title="var">false</span>) /\ ((<span class="id" title="var">checkrsnmylis</span> <span class="id" title="var">n3</span> <span class="id" title="var">l</span>) = <span class="id" title="var">false</span>)/\ ((<span class="id" title="var">checkrsnmylis</span> <span class="id" title="var">n1</span> <span class="id" title="var">l</span>) = <span class="id" title="var">false</span>)  -&gt; ([ <span class="id" title="var">n</span> &lt;- (<span class="id" title="var">If</span> (|<span class="id" title="var">u</span>|#?|<span class="id" title="var">u'</span>|) <span class="id" title="keyword">then</span> (<span class="id" title="var">enc</span> <span class="id" title="var">u</span> (<span class="id" title="var">pke</span> <span class="id" title="var">n1</span>) (<span class="id" title="var">re</span> (<span class="id" title="var">N</span> <span class="id" title="var">n2</span>))) <span class="id" title="keyword">else</span> <span class="id" title="var">u''</span>)] <span class="id" title="var">l</span>) ~ ([ <span class="id" title="var">n</span> &lt;-  (<span class="id" title="var">If</span> (|<span class="id" title="var">u</span>|#?|<span class="id" title="var">u'</span>|) <span class="id" title="keyword">then</span> (<span class="id" title="var">enc</span> <span class="id" title="var">u'</span> (<span class="id" title="var">pke</span> <span class="id" title="var">n1</span>) (<span class="id" title="var">re</span> (<span class="id" title="var">N</span> <span class="id" title="var">n2</span>))) <span class="id" title="keyword">else</span> <span class="id" title="var">u''</span>)] <span class="id" title="var">l</span>).<br/>

<br/>
</div>

<div class="doc">
ENCCCA1 assumption 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">ENCCCA1</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">t</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">u''</span>: <span class="id" title="var">message</span>) (<span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span> <span class="id" title="var">n3</span> :<span class="id" title="var">nat</span>){<span class="id" title="var">m</span>} (<span class="id" title="var">l</span> :<span class="id" title="var">mylist</span> <span class="id" title="var">m</span>), (<span class="id" title="var">leb</span> (<span class="id" title="var">length</span> (<span class="id" title="var">distMvars</span> <span class="id" title="var">l</span>)) 1) = <span class="id" title="var">true</span> /\ (<span class="id" title="var">closMlist</span> [<span class="id" title="var">u</span>; <span class="id" title="var">u'</span>; <span class="id" title="var">u''</span>] = <span class="id" title="var">true</span>) /\ ((<span class="id" title="var">checkrsnmylis</span> <span class="id" title="var">n2</span> <span class="id" title="var">l</span>) = <span class="id" title="var">false</span>) /\ ((<span class="id" title="var">checkrsnmylis</span> <span class="id" title="var">n3</span> <span class="id" title="var">l</span>) = <span class="id" title="var">false</span>)/\ (<span class="id" title="var">checkmtmylis</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span>) = <span class="id" title="var">true</span> /\ (<span class="id" title="var">mVarMsg</span> <span class="id" title="var">t</span> = (<span class="id" title="var">cons</span> <span class="id" title="var">n</span> <span class="id" title="var">nil</span>)) -&gt; (<span class="id" title="var">checkmtmylis</span> (<span class="id" title="var">dec</span> <span class="id" title="var">t</span> (<span class="id" title="var">ske</span> <span class="id" title="var">n1</span>)) <span class="id" title="var">l</span>) = <span class="id" title="var">false</span> -&gt; ([<span class="id" title="var">n</span> &lt;- (<span class="id" title="var">If</span> (|<span class="id" title="var">u</span>|#?|<span class="id" title="var">u'</span>|) <span class="id" title="keyword">then</span> (<span class="id" title="var">enc</span> <span class="id" title="var">u</span> (<span class="id" title="var">pke</span> <span class="id" title="var">n1</span>) (<span class="id" title="var">re</span> (<span class="id" title="var">N</span> <span class="id" title="var">n2</span>))) <span class="id" title="keyword">else</span> <span class="id" title="var">u''</span>)]<span class="id" title="var">l</span>) ~ ([<span class="id" title="var">n</span> &lt;- (<span class="id" title="var">If</span> (|<span class="id" title="var">u</span>|#?|<span class="id" title="var">u'</span>|) <span class="id" title="keyword">then</span> (<span class="id" title="var">enc</span> <span class="id" title="var">u'</span> (<span class="id" title="var">pke</span> <span class="id" title="var">n1</span>) (<span class="id" title="var">re</span> (<span class="id" title="var">N</span> <span class="id" title="var">n2</span>))) <span class="id" title="keyword">else</span> <span class="id" title="var">u''</span>)]<span class="id" title="var">l</span>).<br/>

<br/>
</div>

<div class="doc">
To check if a term t is <span class="inlinecode">(<span class="id" title="var">n1</span></span> <span class="inlinecode"><span class="id" title="var">u</span></span> <span class="inlinecode"><span class="id" title="var">u'</span>)</span> compiant 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">compliant</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <span class="id" title="var">f</span>: <span class="id" title="var">message</span> -&gt; <span class="id" title="var">bool</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">aplycca2comp</span>  (<span class="id" title="var">l</span>:<span class="id" title="var">list</span> <span class="id" title="var">message</span>) :<span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">nil</span> =&gt; <span class="id" title="var">true</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">cons</span> <span class="id" title="var">h</span> <span class="id" title="var">t</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">f</span> <span class="id" title="var">h</span>) (<span class="id" title="var">aplycca2comp</span> <span class="id" title="var">t</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">compliant</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">cca2compmsg</span> (<span class="id" title="var">g</span>:<span class="id" title="var">message</span>-&gt; <span class="id" title="var">message</span>) (<span class="id" title="var">t'</span> <span class="id" title="var">t''</span>:<span class="id" title="var">message</span>) (<span class="id" title="var">n</span> <span class="id" title="var">n1</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">u</span> <span class="id" title="var">u'</span>:<span class="id" title="var">message</span>) (<span class="id" title="var">t</span>:<span class="id" title="var">message</span>) :<span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Mvar</span> <span class="id" title="var">n'</span> =&gt; (<span class="id" title="var">beq_nat</span> <span class="id" title="var">n'</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">N</span> <span class="id" title="var">n'</span> =&gt; (<span class="id" title="var">negb</span> (<span class="id" title="var">beq_nat</span> <span class="id" title="var">n'</span> <span class="id" title="var">n1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ifm_then_else_</span> <span class="id" title="var">b1</span> <span class="id" title="var">t4</span> <span class="id" title="var">t5</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">message_beq</span> <span class="id" title="var">t</span> (<span class="id" title="var">If</span> (<span class="id" title="var">eqm</span> <span class="id" title="var">t'</span> (<span class="id" title="var">Mvar</span> <span class="id" title="var">n</span>)) &amp; (<span class="id" title="var">eqm</span> (<span class="id" title="var">L</span> <span class="id" title="var">u</span>) (<span class="id" title="var">L</span> <span class="id" title="var">u'</span>)) <span class="id" title="keyword">then</span> <span class="id" title="var">t''</span> <span class="id" title="keyword">else</span> (<span class="id" title="var">g</span> (<span class="id" title="var">dec</span> <span class="id" title="var">t'</span> (<span class="id" title="var">ske</span> <span class="id" title="var">n1</span>))))) <span class="id" title="keyword">then</span> <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compbol</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">b1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t4</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t5</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pair</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pi2</span> <span class="id" title="var">t1</span> =&gt;  (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">to</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pi1</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">f</span> <span class="id" title="var">l</span> =&gt; (<span class="id" title="var">aplycca2comp</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span>) <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">V0</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">V1</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pubkey</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
commitments 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">kc</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">comm</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">open</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t3</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
encryptions 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ke</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">re</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">enc</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t3</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dec</span> <span class="id" title="var">t1</span>  <span class="id" title="var">t2</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">andb</span> (<span class="id" title="var">leb</span> 1 (@<span class="id" title="var">count_occ</span> <span class="id" title="var">nat</span> <span class="id" title="var">eq_nat_dec</span> (<span class="id" title="var">mVarMsg</span> <span class="id" title="var">t1</span>) <span class="id" title="var">n</span>)) (<span class="id" title="var">message_beq</span> (<span class="id" title="var">ske</span> <span class="id" title="var">n1</span>) <span class="id" title="var">t2</span>)) <span class="id" title="keyword">then</span> <span class="id" title="var">false</span> <span class="id" title="keyword">else</span> (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>))   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
Blind digital signatures 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">kb</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">rb</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)                                                                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bl</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t3</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ub</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> <span class="id" title="var">t4</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t3</span>))) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t4</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bsign</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t3</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
signatures 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ks</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">rs</span> <span class="id" title="var">t1</span> =&gt; (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>)                                                            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">sign</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t3</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">shufl</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t3</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">cca2compbol</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> (<span class="id" title="var">n</span> <span class="id" title="var">n1</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">u</span> <span class="id" title="var">u'</span>:<span class="id" title="var">message</span>)  (<span class="id" title="var">b</span>:<span class="id" title="var">Bool</span>) :<span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqb</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compbol</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">b1</span>) (<span class="id" title="var">cca2compbol</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span>  <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">b2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">eqm</span>  <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt;  (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span>  <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ifb_then_else_</span>  <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> <span class="id" title="var">b3</span> =&gt;  (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compbol</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">b1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compbol</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">b2</span>) (<span class="id" title="var">cca2compbol</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">b3</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ver</span>  <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t3</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bver</span>  <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t3</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">acc</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> <span class="id" title="var">t4</span> =&gt; (<span class="id" title="var">andb</span> (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">andb</span> (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t3</span>))) (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t4</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">cca2compos</span> (<span class="id" title="var">g</span>:<span class="id" title="var">message</span> -&gt; <span class="id" title="var">message</span>)  (<span class="id" title="var">t'</span> <span class="id" title="var">t''</span> :<span class="id" title="var">message</span>) (<span class="id" title="var">n</span> <span class="id" title="var">n1</span>:<span class="id" title="var">nat</span>) ( <span class="id" title="var">u</span> <span class="id" title="var">u'</span> :<span class="id" title="var">message</span>) (<span class="id" title="var">t</span>:<span class="id" title="var">oursum</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">msg</span> <span class="id" title="var">s</span> =&gt; <span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">bol</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">cca2compbol</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">cca2compmylis</span> (<span class="id" title="var">g</span>:<span class="id" title="var">message</span> -&gt; <span class="id" title="var">message</span>) (<span class="id" title="var">t'</span> <span class="id" title="var">t''</span>:<span class="id" title="var">message</span>) (<span class="id" title="var">n</span> <span class="id" title="var">n1</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">u</span> <span class="id" title="var">u'</span>:<span class="id" title="var">message</span>) {<span class="id" title="var">m</span>} (<span class="id" title="var">l</span>:<span class="id" title="var">mylist</span> <span class="id" title="var">m</span>):<span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> : <span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> (<span class="id" title="var">cca2compos</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">h</span>) <span class="id" title="keyword">then</span> (<span class="id" title="var">cca2compmylis</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">else</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
ENCCCA2 assumption 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">ENCCCA2</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">u''</span>: <span class="id" title="var">message</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">message</span> -&gt; <span class="id" title="var">message</span>) (<span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span> <span class="id" title="var">n3</span> :<span class="id" title="var">nat</span>){<span class="id" title="var">m</span>} (<span class="id" title="var">l</span> :<span class="id" title="var">mylist</span> <span class="id" title="var">m</span>), (<span class="id" title="var">leb</span> (<span class="id" title="var">length</span> (<span class="id" title="var">distMvars</span> ([<span class="id" title="var">msg</span> <span class="id" title="var">t'</span> , <span class="id" title="var">msg</span> <span class="id" title="var">t''</span>] ++ <span class="id" title="var">l</span>))) 1) = <span class="id" title="var">true</span> /\ (<span class="id" title="var">closMlist</span> [<span class="id" title="var">u</span>; <span class="id" title="var">u'</span>; <span class="id" title="var">u''</span>] = <span class="id" title="var">true</span>) /\ (<span class="id" title="var">cca2compmylis</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">l</span>) = <span class="id" title="var">true</span> /\ ( (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t'</span>) = <span class="id" title="var">true</span>) /\ (<span class="id" title="var">cca2compmsg</span> <span class="id" title="var">g</span> <span class="id" title="var">t'</span> <span class="id" title="var">t''</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span> <span class="id" title="var">u</span> <span class="id" title="var">u'</span> <span class="id" title="var">t''</span>) = <span class="id" title="var">true</span> -&gt; ([<span class="id" title="var">n</span> &lt;- (<span class="id" title="var">If</span> (|<span class="id" title="var">u</span>|#?|<span class="id" title="var">u'</span>|) <span class="id" title="keyword">then</span> (<span class="id" title="var">enc</span> <span class="id" title="var">u</span> (<span class="id" title="var">pke</span> <span class="id" title="var">n1</span>) (<span class="id" title="var">re</span> (<span class="id" title="var">N</span> <span class="id" title="var">n2</span>))) <span class="id" title="keyword">else</span> <span class="id" title="var">u''</span>)]<span class="id" title="var">l</span>) ~ ([<span class="id" title="var">n</span> &lt;- (<span class="id" title="var">If</span> (|<span class="id" title="var">u</span>|#?|<span class="id" title="var">u'</span>|) <span class="id" title="keyword">then</span> (<span class="id" title="var">enc</span> <span class="id" title="var">u'</span> (<span class="id" title="var">pke</span> <span class="id" title="var">n1</span>) (<span class="id" title="var">re</span> (<span class="id" title="var">N</span> <span class="id" title="var">n2</span>))) <span class="id" title="keyword">else</span> <span class="id" title="var">u''</span>)]<span class="id" title="var">l</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab9"></a><h1 class="section">Example 12.2</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
few tactics 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">tryrewhyps</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span> [<span class="id" title="var">beq_nat</span> ?<span class="id" title="var">n1</span> ?<span class="id" title="var">n2</span>] ] =&gt;  <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <span class="id" title="var">beq_nat</span> <span class="id" title="var">n2</span> <span class="id" title="var">n1</span> = ?<span class="id" title="var">Y</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Nat.eqb_sym</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H1</span>: <span class="id" title="var">beq_nat</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span> = ?<span class="id" title="var">Y1</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>